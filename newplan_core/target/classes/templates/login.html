<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="icon" href="images/favicon.png">
	<title>Edugo - Education Mobile Template</title>

	<link th:href="@{/static/css/materialize.css}" rel="stylesheet">
	<link th:href="@{/static/css/loader.css}" rel="stylesheet">
	<link th:href="@{/static/css/fontawesome.min.css}" rel="stylesheet">
	<link th:href="@{/static/css/owl.carousel.min.css}" rel="stylesheet">
	<link th:href="@{/static/css/owl.theme.default.min.css}" rel="stylesheet">
	<link th:href="@{/static/css/style.css}" rel="stylesheet">

	<!-- end login -->

	<script th:src="@{/static/js/jquery.min.js}"></script>
	<script th:src="@{/static/js/materialize.min.js}"></script>
	<script th:src="@{/static/js/owl.carousel.min.js}"></script>
	<script th:src="@{/static/js/main.js}"></script>

	<!--sweet-->

	<link th:href="@{/static/css/sweetalert.css}" rel="stylesheet">
	<script th:src="@{/static/js/sweetalert-dev.js}" ></script>

	<script>
		// init qq登录的请求地址
		$(document).ready(function () {
			var photo = window.localStorage.getItem("photo");
			var nickname = window.localStorage.getItem("nickname");
			if(photo != '' || photo != 'null'){
				$("#photo").attr("src",photo);
			}
			if(nickname != '' || nickname != 'null'){
				document.getElementById("nickname").innerText= nickname;
			}

			$.ajax({
				url:"/user/getCode",
				type:"get",
				dataType:"text",
				success:function(code){
					if(code != null){
						$("#qqlogin").attr("href",code);
					}else{
						$("#qqlogin").attr("href","www.zby123.club");
					}
				}
			})
		});
	</script>
	<script>
		/*
            登录请求
         */
		function login() {
			var username=$("#username").val();
			var password=$("#password").val();

			$.ajax({  // ajax登陆请求
				url:"/user/login",
				dataType:'json',
				// contentType: "application/json;charset=utf-8",
				type:"POST",
				data: {
					"username":username,
					"password":password
				},
				success:function(Result){

					if(Result.flag){
						swal("登录","登录成功1","success");
						headerSetup(Result.message,Result.data);
						window.location.href = '/user/index';
						// request.setRequestHeader("Authorization", "Bearer " +Result.data);
						// alert("看放进去没：" + window.localStorage.getItem("Authrorization"));
						// swal("测试阶段，看一下token！",window.localStorage.getItem("Authrorization"));
						// window.location.href="/pages/mainview/" + Result.data.id;//view

					}else {
						document.getElementById('password').value = '' ;
					}
				}
			});
		}

		/*
            保存token和基本信息
         */
		function headerSetup(token,data)
		{
			var storage = window.localStorage;
			if(!storage){
				// alert("浏览器不支持localstorage");
				swal("完蛋","您的浏览器不支持Storage","error");
				return false;
			}
			storage.setItem("Authrorization", "Bearer " +token);	//保存token
			storage.setItem("user_login_time", new Date().getTime());//保存登录时间
			storage.setItem("photo", data.photo);//保存头像
			storage.setItem("nickname", data.nickname);//保存昵称


		}
	</script>

</head>
<body>

	<!-- preloader -->
	<div class="loader-wrapper">
		<div class="loader-cube"></div>
	</div>
	<!-- end preloader -->

	<!-- navbar -->
	<div class="navbar">
		<div class="container">
			<div class="row">
				<div class="col s6">
					<div class="content-left">
						<a href="index.html">
							<h1>
								<span class="color-indigo1">E</span><span class="color-indigo2">D</span><span class="color-indigo3">U</span><span class="color-indigo4">G</span><span class="color-indigo5">O</span>
							</h1>
						</a>
					</div>
				</div>
				<div class="col s6">
					<div class="content-right">
						<a href="#slide-out" data-activates="slide-out" class="sidebar"><i class="fas fa-bars"></i></a>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end navbar -->

	<!-- sidebar left -->
	<div class="sidebar-panel">
		<ul id="slide-out" class="collapsible side-nav">
			<li class="list-top">
				<div class="user-view">
					<img id="photo" th:src="@{/static/images/testimonial1.png}" class="responsive-img" alt="">
					<h4 id="nickname">Marchel Agata</h4>
					<span>New York</span>
				</div>
			</li>
			<li>
				<div class="collapsible-header">
					<i class="fas fa-home"></i>Home<span><i class="fas fa-angle-right right"></i></span>
				</div>
				<div class="collapsible-body">
					<ul>
						<li><a href="index.html">Home</a></li>
						<li><a href="index2.html">Home v2</a></li>
					</ul>
				</div>
			</li>
			<li><a href="course.html"><i class="fas fa-graduation-cap"></i>Course</a></li>
			<li><a href="teacher.html"><i class="fas fa-user"></i>Teacher</a></li>
			<li><a href="event.html"><i class="fas fa-calendar-alt"></i>Event</a></li>
			<li>
				<div class="collapsible-header">
					<i class="fas fa-clone"></i>Blog<span><i class="fas fa-angle-right right"></i></span>
				</div>
				<div class="collapsible-body">
					<ul>
						<li><a href="blog.html">Blog</a></li>
						<li><a href="blog-single.html">Blog Single</a></li>
					</ul>
				</div>
			</li>
			<li>
				<div class="collapsible-header">
					<i class="fas fa-clone"></i>Pages<span><i class="fas fa-angle-right right"></i></span>
				</div>
				<div class="collapsible-body">
					<ul>
						<li><a href="about.html">About</a></li>
						<li><a href="features.html">Features</a></li>
						<li><a href="services.html">Services</a></li>
						<li><a href="gallery.html">Gallery</a></li>
						<li><a href="page-not-found.html">Page Not Found</a></li>
						<li><a href="pricing-table.html">Pricing</a></li>
					</ul>
				</div>
			</li>
			<li><a href="contact.html"><i class="fas fa-envelope"></i>Contact</a></li>
			<li><a href="login.html"><i class="fas fa-sign-in-alt"></i>Login</a></li>
			<li><a href="register.html"><i class="fas fa-user-plus"></i>Register</a></li>
			<li><a href="index.html"><i class="fas fa-sign-out-alt"></i>Log Out</a></li>
		</ul>
	</div>
	<!-- end sidebar left -->

	<!-- login -->
	<div class="login segments-page">
		<div class="container">
			<div class="contact-title">
				<h3>Login</h3>
			</div>
			<div class="wrap-form">
				<form>
					<input type="text" name="username" id="username" placeholder="Name">
					<input type="password" name="password" id="password" placeholder="Password">
					<p>
						<input type="checkbox" id="rememberMe">
						<label for="rememberMe"><span>Remember Me</span></label>
					</p>
					<button class="button" onclick="login()">Login</button>
				</form>
			</div>
			<div class="info">
				<ul>
					<li>Don't have an account?
						<a href="register.html">Create Account</a>
					</li>
					<li>
						<a href="http://astylers.com/edugo/forgot-password.html">Forgot Your Password</a>
					</li>
				</ul>
			</div>
			<div class="social-login">
				<div class="social-fb">
<!--					<h6><i class="fab fa-facebook-f"></i>Login With QQ</h6>-->
					<a id="qqlogin" href="" ><img th:src="@{/static/images/qqlogin.png}"><h6><i></i>Login With QQ</h6></a>

				</div>
				<div class="social-google">
					<h6><i class="fab fa-google"></i>Login With Google</h6>
				</div>
			</div>
		</div>
	</div>

</body>
</html>
